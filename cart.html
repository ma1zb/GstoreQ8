<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚ - GstoreQ8</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" href="images/logoapp.png">
</head>
<body>
  <header>
    <img src="images/logo.png" alt="Gstore Logo" class="logo">
    <h1>GstoreQ8</h1>
    <nav>
      <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <a href="products.html">Ù…Ù†ØªØ¬Ø§ØªÙ†Ø§</a>
      <a href="cart.html">ğŸ›’Ø§Ù„Ø³Ù„Ø©</a>
      <a href="about.html">Ø­ÙˆÙ„</a>
      <a href="contact.html">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a>
    </nav>
  </header>

  <main>
    <h2>Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</h2>
    <div class="cart-container">
      <table class="cart-table">
        <thead>
          <tr>
            <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
            <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
            <th>Ø§Ù„Ø³Ø¹Ø±</th>
            <th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th>
            <th>Ø¥Ø²Ø§Ù„Ø©</th>
          </tr>
        </thead>
        <tbody id="cart-items">
          <!-- ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¹Ø¨Ø± JavaScript -->
        </tbody>
      </table>
      <div class="cart-total">
        <strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ:</strong> 0 JD
      </div>
      <button class="checkout-btn">Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø´Ø±Ø§Ø¡</button>
      <button id="clear-cart" class="clear-btn">Ø¥ÙØ±Ø§Øº Ø§Ù„Ø³Ù„Ø©</button>
    </div>
  </main>

  <footer>
    &copy; 2025 GstoreQ8. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©
  </footer>

  <script>
    let cartItems = JSON.parse(localStorage.getItem('cart')) || [];
    const tbody = document.getElementById('cart-items');
    let total = 0;

    function renderCart() {
      tbody.innerHTML = '';
      total = 0;

      cartItems.forEach((item, index) => {
        const subtotal = item.price * item.quantity;
        total += subtotal;

        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${item.name}</td>
          <td>${item.quantity}</td>
          <td>${item.price} JD</td>
          <td>${subtotal} JD</td>
          <td><button class="remove-btn" data-index="${index}">Ø­Ø°Ù</button></td>
        `;
        tbody.appendChild(row);
      });

      document.querySelector('.cart-total').innerHTML = `<strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ:</strong> ${total} JD`;

      document.querySelectorAll('.remove-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const index = btn.dataset.index;
          cartItems.splice(index, 1);
          localStorage.setItem('cart', JSON.stringify(cartItems));
          renderCart();
        });
      });
    }

    renderCart();

    document.getElementById('clear-cart').addEventListener('click', () => {
      if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥ÙØ±Ø§Øº Ø§Ù„Ø³Ù„Ø©ØŸ")) {
        localStorage.removeItem('cart');
        cartItems = [];
        renderCart();
      }
    });

    document.querySelector('.checkout-btn').addEventListener('click', () => {
      if (cartItems.length === 0) {
        alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©.");
        return;
      }

      let orderNumber = parseInt(localStorage.getItem('orderNumber') || '1');
      const invoiceDate = new Date().toLocaleDateString('ar-EG');
      let total = 0;

      let invoiceHTML = `
        <!DOCTYPE html>
        <html lang="ar">
        <head>
          <meta charset="UTF-8">
          <title>ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡</title>
           <style>
    body {
      font-family: Arial, sans-serif;
      direction: rtl;
      padding: 20px;
      background: #f9f9f9;
    }
    .header {
      text-align: center;
      margin-bottom: 20px;
    }
    .header img {
      width: 270px;
      height: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: #fff;
    }
    th {
      background-color: #06d1f5;
      color: white;
      font-weight: bold;
      padding: 10px;
      border: 1px solid #444;
      text-align: center;
    }
    td {
      border: 1px solid #444;
      padding: 10px;
      text-align: center;
    }
    .info {
      margin-top: 10px;
      font-size: 18px;
      color: #333;
    }
    h3 {
      color: #333;
    }
    p {
      text-align: center;
      font-size: 18px;
      margin-top: 20px;
      color: balck;
    }
    .btns {
      text-align: center;
      margin-top: 30px;
      display: flex;
      justify-content: center;
      gap: 20px;
    }
    .btn {
      display: inline-block;
      padding: 12px 28px;
      font-size: 18px;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      user-select: none;
    }
    .print-btn {
      background: linear-gradient(135deg, #06d1f5, #0288d1);
      color: white;
      box-shadow: 0 6px 12px rgba(6, 209, 245, 0.6);
    }
    .print-btn:hover {
      background: linear-gradient(135deg, #0288d1, #01579b);
      box-shadow: 0 8px 16px rgba(6, 209, 245, 0.9);
    }
    .close-btn {
      background: linear-gradient(135deg, #f44336, #d32f2f);
      color: white;
      box-shadow: 0 6px 12px rgba(244, 67, 54, 0.6);
    }
    .close-btn:hover {
      background: linear-gradient(135deg, #d32f2f, #b71c1c);
      box-shadow: 0 8px 16px rgba(244, 67, 54, 0.9);
    }

    /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
    @media print {
      .btns { display: none !important; }
    }
  </style>
        </head>
        <body>
          <div class="header">
            <img src="images/logo.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ØªØ¬Ø±">
            <h2>GstoreQ8 Store</h2>
          </div>
          <div class="info">
            <strong>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨:</strong> ${orderNumber} <br>
            <strong>ØªØ§Ø±ÙŠØ® Ø§Ù„ÙØ§ØªÙˆØ±Ø©:</strong> ${invoiceDate}
          </div>

          <h3 style="text-align:center;">ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡</h3>
          <table>
            <thead>
              <tr>
                <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
                <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                <th>Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©</th>
                <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
              </tr>
            </thead>
            <tbody>
      `;

      cartItems.forEach(item => {
        const subtotal = item.price * item.quantity;
        total += subtotal;
        invoiceHTML += `
          <tr>
            <td>${item.name}</td>
            <td>${item.quantity}</td>
            <td>${item.price} JD</td>
            <td>${subtotal} JD</td>
          </tr>
        `;
      });

      invoiceHTML += `
            </tbody>
          </table>
          <h3 style="text-align:center;">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${total} JD</h3>
          <p>Ø´ÙƒØ±Ø§Ù‹ Ù„ØªØ³ÙˆÙ‚Ùƒ Ù…Ø¹Ù†Ø§</p>
          <div class="btns">
            <button class="btn close-btn" onclick="window.close()">âŒ Ø¥ØºÙ„Ø§Ù‚</button>
            <button class="btn print-btn" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button>
          </div>
        </body>
        </html>
      `;

      const invoiceWindow = window.open('', '_blank', 'width=800,height=600');
      invoiceWindow.document.open();
      invoiceWindow.document.write(invoiceHTML);
      invoiceWindow.document.close();

      // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©
      const timer = setInterval(() => {
        if (invoiceWindow.closed) {
          clearInterval(timer);
          alert("ØªÙ… Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­! Ø±Ù‚Ù… Ø·Ù„Ø¨Ùƒ Ù‡Ùˆ: " + orderNumber);
          localStorage.setItem('orderNumber', orderNumber + 1);
          localStorage.removeItem('cart');
          cartItems = [];
          renderCart();
        }
      }, 500);
    });
  </script>
</body>
</html>
